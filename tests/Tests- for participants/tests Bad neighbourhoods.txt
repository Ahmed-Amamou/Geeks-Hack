TESTs

input1 :

3 5 2
3 2 3 4
.....
.X..X
..X..

OUTPUT1:
5
---------------------------------------------------------------------

input2:
1 6 4
1 1 1 6
......

Output 2:
2

---------------------------------------------------------------------
Input 3:
3 3 1
2 1 2 3
.X.
.X.
.X.

Output3:
-1

---------------------------------------------------------------------
input4:
7 8 3
2 3 3 5
...X....
...X....
...X....
.XXX.X..
....X...
........
....X...

output4:
7
---------------------------------------------------------------------
input5:
7 8 3
2 3 7 1
...X....
...X....
...X....
.XXX.X..
....X...
........
....X...
output5:
3

---------------------------------------------------------------------
input6:
8 8 2
2 3 7 1
...X....
........
........
XXXXXXXX
....X...
........
....X...
........
output6:
-1
---------------------------------------------------------------------
input7:
21 20 2
1 1 21 20
....................
....................
.XXXXX.XXXXXXXX.....
....................
.....XXXXX..XXXX....
....................
...X................
...X...........XXXXX
...X................
...XXXXXXXXXXXXXX...
......X.............
......X.............
......X.............
......X.............
..XXXXXXXXXXX.......
....................
....................
....................
....................
........XXXXXXXXX.XX
....................
output7:
20

---------------------------------------------------------------------
input8:
21 21 5
4 2 20 18
....................
.........X...X......
..........X.X.......
...........X........
..........X........X
.........X........X.
.XXX....X........X..
.......X.......X....
......X.......X.....
.....X.X....X.......
....X.X....X........
...X.X....X.........
..X......X..........
.XXX......X.........
XXXXX......X........
.....X......X.......
......X......X......
.......X......X.....
........X......X....
.........X......X...
..........X......X..

output8:
9

---------------------------------------------------------------------
input9:
50 79 1
1 1 50 79
...............................................................................
...............................................................................
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
...............................................................................
...............................................................................
...............................................................................
...............................................................................
...............................................................................
...............................................................................
...............................................................................
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
...............................................................................
.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
...............................................................................
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
output9:
127
---------------------------------------------------------------------
input10:
9 79 100
1 1 8 78
....XXXXXXXXX...XXXXXXXXXX.....XXXXXXXXXX....XX....XXXX......XXXXXXXXXXXX......
....XX..........XX.............XX............XX...XX.........XX................
....XX..........XX.............XX............XX.XX...........XX................
....XX..........XXXXXXXXXX.....XXXXXXXXXX....XXXX............XXXXXXXXXXXX......
....XX..........XX.............XX............XX.XX.....................XX......
....XX....XXXX..XX.............XX............XX...XX...................XX......
....XX......X...XX.............XX............XX.....XX.................XX......
....XXXXXXXXX...XXXXXXXXXX.....XXXXXXXXXX....XX......XXX.....XXXXXXXXXXXX......
...........................................................................X...
output10:
4
